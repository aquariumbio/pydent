
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>pydent.base &#8212; Trident 0.0.33 documentation</title>
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Trident 0.0.33 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><p class="sidebar-subtitle">
    <a href="../../index.html">
        <h1>Trident</h1>
        <h2>0.0.33</h2>
    </a>
</p>

<p>
    Trident is a python scripting API wrapper for Aquarium. With Trident,
    you can create python scripts and apps that mine data, create samples,
    submit laboratory protocols, and more. You are looking at documentation
    for version <b>0.0.33</b>.
</p>
<div>
    <a href="https://circleci.com/gh/klavinslab/trident/tree/master"><img src="https://circleci.com/gh/klavinslab/trident.svg?style=svg" alt="build status"></a>
    <a href="https://badge.fury.io/py/pydent"><img src="https://badge.fury.io/py/pydent.svg" alt="PyPI version" height="18"></a>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for pydent.base</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Aquarium model baseclass</span>

<span class="sd">This module contains the base classes for Trident models.</span>
<span class="sd">Trident models load from JSON and dump to JSON.</span>
<span class="sd">This is accomplished by adding the ``@add_schema`` decorator to classes inherited</span>
<span class="sd">by the Base class.</span>
<span class="sd">Using ``@add_schema`` dynamically creates a model schema that handles dumping and</span>
<span class="sd">loading.</span>

<span class="sd">Features of Trident models:</span>

<span class="sd">    load - models can be loaded from JSON data. Hierarchical JSON is loaded</span>
<span class="sd">    intelligently.</span>

<span class="sd">.. code-block:: python</span>

<span class="sd">    Sample.load({&quot;name&quot;: &quot;MyPrimer&quot;, &quot;sample_type&quot;: {&quot;name&quot;: &quot;Primer&quot;, ...} })</span>
<span class="sd">    # =&gt; &lt;Sample(name=&quot;MyPrimer&quot;, sample_type=&lt;SampleType(name=&quot;Primer&quot;)&gt;)&gt;</span>

<span class="sd">dump - models can be dumped to JSON. Dependent models and relationships can be</span>
<span class="sd">       dumped as well.</span>

<span class="sd">.. code-block:: python</span>

<span class="sd">    s.dump(include=(&quot;sample_type&quot;))</span>

<span class="sd">relationships - models relationships are stored</span>

<span class="sd">.. code-block:: python</span>

<span class="sd">    s = Sample.load(</span>
<span class="sd">        {&quot;name&quot;: &quot;MyPrimer&quot;,</span>
<span class="sd">        &quot;sample_type_id&quot;: 1}</span>
<span class="sd">    )</span>

<span class="sd">    primer_type = s.sample_type</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">pydent.exceptions</span> <span class="k">import</span> <span class="n">TridentModelNotFoundError</span><span class="p">,</span> <span class="n">AquariumModelError</span>
<span class="kn">from</span> <span class="nn">pydent.marshaller</span> <span class="k">import</span> <span class="n">MarshallerBase</span>
<span class="kn">from</span> <span class="nn">inflection</span> <span class="k">import</span> <span class="n">underscore</span>


<div class="viewcode-block" id="ModelRegistry"><a class="viewcode-back" href="../../developer/_autosummary/pydent.base.html#pydent.base.ModelRegistry">[docs]</a><span class="k">class</span> <span class="nc">ModelRegistry</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Stores a list of models that can be accessed by name.&quot;&quot;&quot;</span>
    <span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">selfdict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Saves model to the registry&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">selfdict</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;ModelBase&quot;</span><span class="p">:</span>
            <span class="n">ModelRegistry</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">cls</span>

<div class="viewcode-block" id="ModelRegistry.get_model"><a class="viewcode-back" href="../../developer/_autosummary/pydent.base.html#pydent.base.ModelRegistry.get_model">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_model</span><span class="p">(</span><span class="n">model_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets model by model_name&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">model_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ModelRegistry</span><span class="o">.</span><span class="n">models</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TridentModelNotFoundError</span><span class="p">(</span>
                <span class="s2">&quot;Model </span><span class="se">\&quot;</span><span class="si">{}</span><span class="se">\&quot;</span><span class="s2"> not found in ModelRegistry.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model_name</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ModelRegistry</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">model_name</span><span class="p">]</span></div>

    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Special warning for attribute errors.</span>
<span class="sd">        Its likely that user may have wanted to use a model interface instead of</span>
<span class="sd">        the Base class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;&#39;</span><span class="si">{0}</span><span class="s2">&#39; has no attribute &#39;</span><span class="si">{1}</span><span class="s2">&#39;. Method may be a ModelInterface method.&quot;</span>
                             <span class="s2">&quot; Did you mean &#39;&lt;yoursession&gt;.</span><span class="si">{0}</span><span class="s2">.</span><span class="si">{1}</span><span class="s2">&#39;?&quot;</span>
                             <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">item</span><span class="p">))</span></div>


<div class="viewcode-block" id="ModelBase"><a class="viewcode-back" href="../../developer/_autosummary/pydent.base.html#pydent.base.ModelBase">[docs]</a><span class="k">class</span> <span class="nc">ModelBase</span><span class="p">(</span><span class="n">MarshallerBase</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ModelRegistry</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for Aquarium models.</span>
<span class="sd">    Subclass of :class:`pydent.marshaller.MarshallerBase`</span>

<span class="sd">    - creates instances from JSON using `load`</span>
<span class="sd">    - contains a reference to the :class:`pydent.session.aqsession.AqSession`</span>
<span class="sd">      instance that loaded this model</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_global_record_id</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">model_args</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_session</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rid</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_new_record_id</span><span class="p">()</span>
        <span class="n">model_args</span><span class="p">[</span><span class="s1">&#39;rid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rid</span>
        <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">model_args</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">model_args</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;_session&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_track_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_new_record_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rid</span> <span class="o">=</span> <span class="n">ModelBase</span><span class="o">.</span><span class="n">new_record_id</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">new_record_id</span><span class="p">():</span>
        <span class="n">oid</span> <span class="o">=</span> <span class="n">ModelBase</span><span class="o">.</span><span class="n">_global_record_id</span>
        <span class="n">ModelBase</span><span class="o">.</span><span class="n">_global_record_id</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">oid</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rid</span>

    <span class="k">def</span> <span class="nf">_track_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_schema</span><span class="p">:</span>
            <span class="n">schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_schema</span><span class="p">()</span>
            <span class="n">schema</span><span class="o">.</span><span class="n">load_missing</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">schema</span><span class="o">.</span><span class="n">save_extra_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">schema</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<div class="viewcode-block" id="ModelBase.append_to_many"><a class="viewcode-back" href="../../developer/_autosummary/pydent.base.html#pydent.base.ModelBase.append_to_many">[docs]</a>    <span class="k">def</span> <span class="nf">append_to_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appends a model to the many relationship</span>

<span class="sd">        :param name: name of the relationship or attribute</span>
<span class="sd">        :type name: str</span>
<span class="sd">        :param model: model to append</span>
<span class="sd">        :type model: ModelBase</span>
<span class="sd">        :return: None</span>
<span class="sd">        :rtype: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">relationships</span><span class="p">:</span>
            <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relationships</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">model</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="n">field</span><span class="o">.</span><span class="n">model</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">AquariumModelError</span><span class="p">(</span><span class="s2">&quot;Cannot &#39;append_to_many.&#39; Model must be a &#39;</span><span class="si">{}</span><span class="s2">&#39; but found a &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">field</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">many</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
                <span class="n">val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">set_model_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">):</span>
        <span class="n">model_name</span> <span class="o">=</span> <span class="n">underscore</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">attr</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">attr</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">model</span>

<div class="viewcode-block" id="ModelBase.load"><a class="viewcode-back" href="../../developer/_autosummary/pydent.base.html#pydent.base.ModelBase.load">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new model instance from loaded attributes&quot;&quot;&quot;</span>
        <span class="n">inst</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inst</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">_inst</span> <span class="ow">in</span> <span class="n">inst</span><span class="p">:</span>
                <span class="n">_inst</span><span class="o">.</span><span class="n">_new_record_id</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">inst</span><span class="o">.</span><span class="n">_new_record_id</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">inst</span></div>

<div class="viewcode-block" id="ModelBase.dump"><a class="viewcode-back" href="../../developer/_autosummary/pydent.base.html#pydent.base.ModelBase.dump">[docs]</a>    <span class="k">def</span> <span class="nf">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="s1">&#39;rid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rid</span>
        <span class="k">return</span> <span class="n">d</span></div>

<div class="viewcode-block" id="ModelBase.reload"><a class="viewcode-back" href="../../developer/_autosummary/pydent.base.html#pydent.base.ModelBase.reload">[docs]</a>    <span class="k">def</span> <span class="nf">reload</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reload model attributes from new data</span>

<span class="sd">        :param data: data to update model instance</span>
<span class="sd">        :type data: dict</span>
<span class="sd">        :return: model instance</span>
<span class="sd">        :rtype: ModelBase</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">temp_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
        <span class="n">temp_model</span><span class="o">.</span><span class="n">connect_to_session</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>
        <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">temp_model</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">session</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The connected session instance.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session</span>

<div class="viewcode-block" id="ModelBase.connect_to_session"><a class="viewcode-back" href="../../developer/_autosummary/pydent.base.html#pydent.base.ModelBase.connect_to_session">[docs]</a>    <span class="k">def</span> <span class="nf">connect_to_session</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">session</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Connect model instance to a session. Does nothing if session already exists.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_session</span> <span class="o">=</span> <span class="n">session</span></div>

<div class="viewcode-block" id="ModelBase._check_for_session"><a class="viewcode-back" href="../../developer/_autosummary/pydent.base.html#pydent.base.ModelBase._check_for_session">[docs]</a>    <span class="k">def</span> <span class="nf">_check_for_session</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Raises error if model is not connected to a session&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;No AqSession instance found for &#39;</span><span class="si">{}</span><span class="s2">&#39;. Use &#39;connect_to_session&#39; &quot;</span>
                                 <span class="s2">&quot;to connect this model to a session&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span></div>

<div class="viewcode-block" id="ModelBase.no_getter"><a class="viewcode-back" href="../../developer/_autosummary/pydent.base.html#pydent.base.ModelBase.no_getter">[docs]</a>    <span class="k">def</span> <span class="nf">no_getter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback that always returns None&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="k">def</span> <span class="nf">create_interface</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">interface</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>

<div class="viewcode-block" id="ModelBase.interface"><a class="viewcode-back" href="../../developer/_autosummary/pydent.base.html#pydent.base.ModelBase.interface">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">interface</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">session</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a model interface from this class and a session</span>

<span class="sd">        This method can be overridden in model definitions for special cases.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">session</span><span class="o">.</span><span class="n">model_interface</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span></div>

<div class="viewcode-block" id="ModelBase.find"><a class="viewcode-back" href="../../developer/_autosummary/pydent.base.html#pydent.base.ModelBase.find">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">find</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="n">model_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Finds a model instance by its model_id&quot;&quot;&quot;</span>
        <span class="n">interface</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">interface</span><span class="p">(</span><span class="n">session</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">interface</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">model_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="ModelBase.where"><a class="viewcode-back" href="../../developer/_autosummary/pydent.base.html#pydent.base.ModelBase.where">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">where</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Finds a list of models by some parameters&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">interface</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">interface</span><span class="p">(</span><span class="n">session</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">interface</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="ModelBase.find_callback"><a class="viewcode-back" href="../../developer/_autosummary/pydent.base.html#pydent.base.ModelBase.find_callback">[docs]</a>    <span class="k">def</span> <span class="nf">find_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">model_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Finds a model using the model interface and model_id. Used to find</span>
<span class="sd">        models in model relationships.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_for_session</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">model_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">ModelRegistry</span><span class="o">.</span><span class="n">get_model</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">,</span> <span class="n">model_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="ModelBase.where_callback"><a class="viewcode-back" href="../../developer/_autosummary/pydent.base.html#pydent.base.ModelBase.where_callback">[docs]</a>    <span class="k">def</span> <span class="nf">where_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Finds models using a model interface and a set of parameters. Used to</span>
<span class="sd">        find models in model relationships.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_for_session</span><span class="p">()</span>
        <span class="n">query_arg</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query_arg</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">query_arg</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">list</span><span class="p">(</span><span class="n">query_arg</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="kc">None</span> <span class="ow">in</span> <span class="n">query_arg</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">ModelRegistry</span><span class="o">.</span><span class="n">get_model</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">,</span> <span class="n">query_arg</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

    <span class="c1"># def patch(self, json_data):</span>
    <span class="c1">#     &quot;&quot;&quot;Make a patch request to self using json_data. Reload model instance with new data&quot;&quot;&quot;</span>
    <span class="c1">#     result = self.create_interface().patch(self.id, json_data=json_data)</span>
    <span class="c1">#     self.reload(data=result)</span>
    <span class="c1">#     return self</span>
    <span class="c1">#</span>
    <span class="c1"># def patch_with_self(self, **kwargs):</span>
    <span class="c1">#     &quot;&quot;&quot;Update changes to this model instance to Aquarium.&quot;&quot;&quot;</span>
    <span class="c1">#     json_data = self.dump(**kwargs)</span>
    <span class="c1">#     return self.patch(json_data=json_data)</span>

    <span class="k">def</span> <span class="nf">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Override getattribute to automatically connect sessions&quot;&quot;&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">MarshallerBase</span><span class="p">):</span>
            <span class="n">relationships</span> <span class="o">=</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;get_relationships&quot;</span><span class="p">)()</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">relationships</span><span class="p">:</span>
                <span class="n">session</span> <span class="o">=</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;session&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">connect_to_session</span><span class="p">(</span><span class="n">session</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">res</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">res</span><span class="o">.</span><span class="n">connect_to_session</span><span class="p">(</span><span class="n">session</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Trident 0.0.33 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, University of Washington.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
  </body>
</html>